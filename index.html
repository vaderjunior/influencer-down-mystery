<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>A Cucumber City Murder Mystery</title>
    <style>
        :root {
            --blood-red: #a80404;
            --dark-red: #5a0000;
            --paper: #e6e6e6;
            --ink: #111;
            --gold: #d4af37;
            --bg: #0d0d0d;
        }

        * { box-sizing: border-box; }

        body {
            background-color: var(--bg);
            color: var(--paper);
            font-family: 'Courier New', Courier, monospace;
            margin: 0;
            padding: 0;
            min-height: 100vh;
        }

        /* --- UTILS --- */
        .hidden { display: none !important; }
        .text-center { text-align: center; }
        .red-text { color: var(--blood-red); font-weight: bold; }
        .gold-text { color: var(--gold); }
        .container { max-width: 800px; margin: 0 auto; padding: 20px; }

        /* --- LOGIN SCREEN --- */
        .login-screen {
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background: radial-gradient(circle, #1a1a1a 0%, #000 100%);
            padding: 20px;
        }

        h1 {
            font-size: 1.8rem;
            text-transform: uppercase;
            letter-spacing: 2px;
            color: var(--blood-red);
            text-shadow: 2px 2px 0px #000;
            margin-bottom: 5px;
            text-align: center;
            border-bottom: 2px solid var(--blood-red);
            padding-bottom: 10px;
        }

        .subtitle { font-size: 0.9rem; color: #888; margin-bottom: 30px; font-style: italic; }

        input[type="number"], input[type="text"] {
            background: #222;
            border: 1px solid #444;
            color: var(--gold);
            padding: 15px;
            font-size: 1.5rem;
            text-align: center;
            width: 100%;
            max-width: 300px;
            margin-bottom: 15px;
            font-family: inherit;
            border-radius: 4px;
            outline: none;
            letter-spacing: 5px;
        }

        button {
            background: var(--blood-red);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 1rem;
            text-transform: uppercase;
            font-weight: bold;
            cursor: pointer;
            letter-spacing: 1px;
            border-radius: 4px;
            box-shadow: 0 4px 0 var(--dark-red);
            transition: all 0.2s;
            width: 100%;
            max-width: 300px;
        }

        button:active { transform: translateY(4px); box-shadow: none; }

        /* --- DASHBOARDS --- */
        .dashboard-header {
            border-bottom: 2px solid var(--blood-red);
            padding-bottom: 10px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .char-name { font-size: 1.2rem; color: var(--gold); font-weight: bold; }
        .logout-btn { background: #333; font-size: 0.7rem; padding: 5px 10px; box-shadow: none; width: auto; }

        .card {
            background: #1a1a1a;
            border: 1px solid #333;
            margin-bottom: 15px;
            border-radius: 6px;
            overflow: hidden;
        }

        .card-header {
            padding: 15px;
            background: #222;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            border-bottom: 1px solid #333;
        }

        .card-title { font-weight: bold; color: #ddd; }
        .status-icon { font-size: 1.2rem; }

        .card-content {
            padding: 20px;
            background: var(--paper);
            color: var(--ink);
            display: none; 
            border-top: 4px solid var(--blood-red);
        }

        .card.open .card-content { display: block; }
        .card.locked { opacity: 0.7; }
        .card.locked .card-header { background: #111; color: #666; cursor: default; }

        .clue-box {
            background: #fff;
            border: 2px dashed #000;
            padding: 10px;
            margin: 10px 0;
        }

        /* --- ADMIN SPECIFIC --- */
        .admin-panel { background: #111; min-height: 100vh; }
        
        .guide-step {
            border-left: 3px solid var(--gold);
            padding-left: 10px;
            margin-bottom: 15px;
        }
        .guide-say {
            font-style: italic;
            background: #e1e1e1;
            padding: 10px;
            border-radius: 4px;
            margin-top: 5px;
            color: #000;
        }

        .master-row {
            font-size: 0.8rem;
            border-bottom: 1px solid #ccc;
            padding-bottom: 10px;
            margin-bottom: 10px;
        }

        .timer-display {
            font-size: 2rem; color: var(--gold); text-align: center; 
            background: #000; padding: 10px; border: 1px solid #333; margin: 10px 0;
            font-family: monospace;
        }

        .host-controls {
            display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 5px; margin-bottom: 20px;
        }
        .host-controls button { width: 100%; font-size: 0.8rem; }

        /* --- MODAL --- */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.95);
            z-index: 100;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .modal-box {
            background: #222; border: 2px solid var(--blood-red);
            padding: 20px; width: 90%; max-width: 400px; text-align: center;
        }

    </style>
</head>
<body>

    <!-- 1. LOGIN SCREEN -->
    <div id="loginView" class="login-screen">
        <h1>A Cucumber City<br>Murder Mystery</h1>
        <p class="subtitle">Enter your 5-digit Access Code</p>
        <!-- type="number" ensures numeric keypad on mobile -->
        <input type="number" id="pinInput" placeholder="PIN CODE">
        <button onclick="handleLogin()">Unlock File</button>
        <p id="loginError" class="red-text hidden" style="margin-top:10px;">Access Denied</p>
    </div>

    <!-- 2. PLAYER DASHBOARD -->
    <div id="playerView" class="container hidden">
        <div class="dashboard-header">
            <div>
                <span style="font-size:0.8rem; color:#888;">IDENTITY:</span><br>
                <span id="playerDisplayName" class="char-name">Name</span>
            </div>
            <button class="logout-btn" onclick="location.reload()">Exit</button>
        </div>

        <!-- Pre-Game -->
        <div class="card open">
            <div class="card-header">
                <span class="card-title">0. THE BRIEFING (Read Now)</span>
                <span class="status-icon">ðŸ”“</span>
            </div>
            <div class="card-content">
                <p id="preGameText">Loading...</p>
            </div>
        </div>

        <!-- Round 1 -->
        <div class="card locked" id="card1">
            <div class="card-header" onclick="tryUnlock(1)">
                <span class="card-title">ROUND 1: Intro</span>
                <span class="status-icon" id="lock1">ðŸ”’</span>
            </div>
            <div class="card-content" id="content1">
                <h3 class="red-text">ROUND 1: FIRST IMPRESSIONS</h3>
                <p><strong>Reveal to Group:</strong> <span id="r1Reveal">...</span></p>
                <div class="clue-box">
                    <strong>SECRET (Hide this):</strong> <span id="r1Secret">...</span>
                </div>
            </div>
        </div>

        <!-- Round 2 -->
        <div class="card locked" id="card2">
            <div class="card-header" onclick="tryUnlock(2)">
                <span class="card-title">ROUND 2: Secrets</span>
                <span class="status-icon" id="lock2">ðŸ”’</span>
            </div>
            <div class="card-content" id="content2">
                <h3 class="red-text">ROUND 2: CONFRONTATION</h3>
                <p><strong>New Clue:</strong> <span id="r2Clue">...</span></p>
                <div class="clue-box">
                    <strong>Strategy:</strong> <span id="r2Strategy">...</span>
                </div>
            </div>
        </div>

        <!-- Round 3 -->
        <div class="card locked" id="card3">
            <div class="card-header" onclick="tryUnlock(3)">
                <span class="card-title">ROUND 3: The Truth</span>
                <span class="status-icon" id="lock3">ðŸ”’</span>
            </div>
            <div class="card-content" id="content3">
                <h3 class="red-text">ROUND 3: FINAL EVIDENCE</h3>
                <p><strong>Final Reveal/Alibi:</strong> <span id="r3Text">...</span></p>
                <p><em>Discuss, then write down your accusation.</em></p>
            </div>
        </div>
    </div>

    <!-- 3. HOST ADMIN DASHBOARD -->
    <div id="adminView" class="container admin-panel hidden">
        <div class="dashboard-header">
            <span class="char-name">HOST CONTROL PANEL</span>
            <button class="logout-btn" onclick="location.reload()">Log Out</button>
        </div>

        <div class="timer-display" id="timer">00:00</div>
        <div class="host-controls">
            <button onclick="startTimer(15)">15 Min</button>
            <button onclick="startTimer(20)">20 Min</button>
            <button onclick="stopTimer()" style="background:#444">Stop</button>
        </div>

        <!-- ADMIN TAB: GAME STATUS -->
        <div class="card open">
            <div class="card-header"><span class="card-title">1. ROUND PASSWORDS</span></div>
            <div class="card-content">
                <p>Shout these out when you want to start a round:</p>
                <ul>
                    <li>Start Round 1: <strong class="red-text">START</strong></li>
                    <li>Start Round 2: <strong class="red-text">SNOW</strong></li>
                    <li>Start Round 3: <strong class="red-text">TRUTH</strong></li>
                </ul>
            </div>
        </div>

        <!-- ADMIN TAB: GUIDE -->
        <div class="card">
            <div class="card-header" onclick="this.parentElement.classList.toggle('open')">
                <span class="card-title">2. HOSTING GUIDE (Read This)</span>
                <span>â–¼</span>
            </div>
            <div class="card-content">
                
                <div class="guide-step">
                    <strong>STEP 0: The Setup</strong><br>
                    Make sure everyone has logged in with their PIN.
                    <div class="guide-say">
                        "Welcome to Cucumber City. The storm has trapped us here. Rahul is dead in the kitchen. Poisoned GlÃ¼hwein. The police can't make it until morning."
                    </div>
                </div>

                <div class="guide-step">
                    <strong>STEP 1: Start Round 1</strong><br>
                    Tell everyone the password is <strong>START</strong>.<br>
                    Ask everyone to introduce themselves.
                    <div class="guide-say">
                        "Everyone, unlock Round 1. Go around the circle. Who are you and where were you when Rahul died?"
                    </div>
                </div>

                <div class="guide-step">
                    <strong>STEP 2: Mingle (15 Mins)</strong><br>
                    Set the timer. As <strong>Freddy</strong>, complain about the heating or the rent money.
                </div>

                <div class="guide-step">
                    <strong>STEP 3: Start Round 2</strong><br>
                    When time is up, shout password <strong>SNOW</strong>.<br>
                    Everyone gets new clues. They must now ACCUSE others.
                    <div class="guide-say">
                        "New info has come to light. Share your clues. Who is lying?"
                    </div>
                </div>

                <div class="guide-step">
                    <strong>STEP 4: Start Round 3</strong><br>
                    Shout password <strong>TRUTH</strong>.<br>
                    This is the final evidence. Give them 5 mins to read and discuss. Then ask for a vote.
                </div>

                <div class="guide-step">
                    <strong>STEP 5: The Solution</strong><br>
                    After voting, read the solution:
                    <div class="guide-say">
                        "The killer is <strong>Priya</strong>. Rahul stole her code in college. She crushed sleeping pills into his drink to delete files from his phone. Combined with his painkillers, it killed him. Priya is the murderer."
                    </div>
                </div>

            </div>
        </div>

        <!-- ADMIN TAB: MASTER LIST -->
        <div class="card">
            <div class="card-header" onclick="this.parentElement.classList.toggle('open')">
                <span class="card-title">3. MASTER DOSSIER (Your Clues Here)</span>
                <span>â–¼</span>
            </div>
            <div class="card-content" id="masterListContainer">
                <!-- Javascript will load all player info here -->
            </div>
        </div>

    </div>

    <!-- 4. PASSWORD POPUP -->
    <div id="passwordModal" class="modal-overlay hidden">
        <div class="modal-box">
            <h3>Enter Round Password</h3>
            <p style="color:#888; font-size:0.8rem;">(Host will announce this)</p>
            <!-- Changed to text to allow letters for passwords like START -->
            <input type="text" id="roundPasswordInput" placeholder="PASSWORD">
            <button onclick="checkPassword()">Unlock</button>
            <p id="pwdError" class="red-text hidden">Wrong Password</p>
            <br>
            <button onclick="closeModal()" style="background:transparent; border:1px solid #666; font-size:0.8rem;">Cancel</button>
        </div>
    </div>

    <script>
        // --- GAME DATA ---
        const ROUND_PASSWORDS = { 1: "START", 2: "SNOW", 3: "TRUTH" };

        const CHARACTERS = {
            "12093": {
                name: "Arjun",
                role: "The Wannabe Influencer",
                pre: "You live for the Gram. Everything is content. You were Rahul's childhood friend, but lately, the friendship has been purely for show.",
                r1_rev: "I was in the living room setting up my ring light when Rahul died.",
                r1_sec: "You were actually jealous that Rahul had more followers than you.",
                r2_clue: "I saw Varun begging Rahul for money in the hallway earlier.",
                r2_strat: "If asked about filming, say 'This is true crime content, it goes viral!'",
                r3_text: "ALIBI: Your live stream timestamp proves you were nowhere near the drink when he poured it."
            },
            "88976": {
                name: "Priya",
                role: "The Stressed Topper",
                pre: "You are doing your PhD. You are exhausted. Professional rival to Rahul.",
                r1_rev: "I was in the library reading. I have no time for murder, I have a thesis due.",
                r1_sec: "YOU ARE THE KILLER. You crushed sleeping pills into his drink. You just wanted to knock him out to delete stolen code from his phone. Act innocent!",
                r2_clue: "Reveal that Divya was crying in the bathroom saying 'I wish he was dead'.",
                r2_strat: "Lie! If asked about your relationship, say you were just 'friendly classmates'.",
                r3_text: "THE SLIP UP: Someone finds burnt paper. It looks like YOUR code. Claim Rahul stole it years ago."
            },
            "45221": {
                name: "Deepak",
                role: "The Gym Bro",
                pre: "All you care about is protein. You brought your own powder because 'German carbs are trash'.",
                r1_rev: "I was doing pushups on the balcony. The cold is good for testosterone.",
                r1_sec: "You stole Rahul's expensive watch AFTER he collapsed. It's in your protein jar.",
                r2_clue: "I saw Sneha spitting in Rahul's food earlier.",
                r2_strat: "Flex your muscles and suspect anyone who looks weak.",
                r3_text: "ALIBI: You are a thief, not a killer. Admit to the watch if pressed, but deny the murder."
            },
            "99823": {
                name: "Anjali",
                role: "The Gossip Queen",
                pre: "You know everyone's secrets. You love drama.",
                r1_rev: "I was in the kitchen, but I was facing the window! I didn't see who touched his cup.",
                r1_sec: "You saw Priya hovering near the drinks table looking nervous.",
                r2_clue: "I heard Rahul on the phone yelling at Varun about a 'bad investment'.",
                r2_strat: "Stir the pot!",
                r3_text: "CRITICAL CLUE: 'Wait... Rahul complained his drink tasted 'chalky' or 'medicinal'. Not like poison, but like pills.'"
            },
            // Freddy (Host) needs a PIN for the Master List
            "77612": {
                name: "Freddy (YOU)",
                role: "The 'German' Expert",
                pre: "You correct everyone's pronunciation. You organized this trip.",
                r1_rev: "I was checking the thermostat. Everyone keeps touching it! It must be exactly 21 degrees.",
                r1_sec: "You are annoyed Rahul didn't pay his share of the Airbnb rent.",
                r2_clue: "I found a receipt in the trash for 'Strong Sleeping Pills'. It belongs to Priya.",
                r2_strat: "Keep order. Act superior.",
                r3_text: "ALIBI: You were on the phone with the pizza delivery guy (in German) when the body dropped."
            },
            "33409": {
                name: "Lakshmi",
                role: "The Mother Hen",
                pre: "You brought pickles and medicines. You treat everyone like a child.",
                r1_rev: "I was unpacking the pickles. Rahul looked pale, I told him to eat properly.",
                r1_sec: "You gave Rahul a headache pill earlier. People might think you poisoned him!",
                r2_clue: "Defense: 'I gave him a paracetamol! Not poison! Check the strip in my bag!'",
                r2_strat: "Make sure everyone has eaten, even the suspects.",
                r3_text: "CLUE: 'I noticed Priya asked me earlier if I had anything strong for insomnia.'"
            },
            "77102": {
                name: "Varun",
                role: "The Crypto Guy",
                pre: "You drive a rented BMW but you are secretly broke.",
                r1_rev: "I was checking the crypto markets. Bitcoin never sleeps, bro.",
                r1_sec: "Rahul threatened to tell everyone you are broke if you didn't pay him back tonight.",
                r2_clue: "Deflect blame to Sneha. She hates rich people.",
                r2_strat: "Hide your financial trouble at all costs.",
                r3_text: "ALIBI: Your phone shows you were on a Zoom call with your parents at the time of death."
            },
            "22918": {
                name: "Meera",
                role: "The Quiet Artist",
                pre: "You observe everything. You barely speak, which is creepy.",
                r1_rev: "I was sketching the fireplace.",
                r1_sec: "You saw Deepak steal the watch but you haven't said anything yet.",
                r2_clue: "I saw Priya throw something into the fire right after Rahul fell.",
                r2_strat: "Watch people. Draw them.",
                r3_text: "REVEAL: Show your sketch (Pretend to). It shows Priya standing next to Rahul's cup."
            },
            "55067": {
                name: "Jose",
                role: "The Party Animal",
                pre: "You are slightly drunk. You brought the Old Monk.",
                r1_rev: "I poured the drinks! But I poured from the same bottle for everyone! I didn't poison it!",
                r1_sec: "You were too drunk to notice if someone slipped something into the cup.",
                r2_clue: "Rahul was complaining of a headache. Lakshmi gave him a pill, but Priya gave him water.",
                r2_strat: "Offer everyone a drink, even the police.",
                r3_text: "DEFENSE: If accused, offer the accuser a drink."
            },
            "66123": {
                name: "Sneha",
                role: "The Activist",
                pre: "You hate capitalism. You hated the victim openly.",
                r1_rev: "I was in the bathroom. Rahul represents everything wrong with the system.",
                r1_sec: "You wrote 'THIEF' in lipstick on Rahul's mirror earlier to scare him.",
                r2_clue: "Reveal that Manu was trying to hack Rahul's phone earlier.",
                r2_strat: "Lecture people on why the victim was a bad person.",
                r3_text: "DEFENSE: 'I wanted to destroy his reputation, not his body. I am non-violent.'"
            },
            "10101": {
                name: "Manu",
                role: "The Techie",
                pre: "You fix everyone's Wi-Fi. You are socially awkward.",
                r1_rev: "The wifi here is terrible. I was rebooting the router.",
                r1_sec: "You know Rahul's app code was actually stolen. You found proof on the cloud.",
                r2_clue: "I checked the router logs. Priya was offline for 20 minutes before the murder.",
                r2_strat: "Try to hack the wifi.",
                r3_text: "BIG REVEAL: 'I hacked Rahul's email. He sent an email to Priya yesterday threatening to sue her.'"
            },
            "40404": {
                name: "Divya",
                role: "The Ex-Girlfriend",
                pre: "You dated the victim. Messy breakup. You are emotional.",
                r1_rev: "I was crying on the stairs. He is a jerk!",
                r1_sec: "You still have a key to his apartment in Kochi.",
                r2_clue: "Suspicion: Admit you sent him a text saying 'You will pay for this'.",
                r2_strat: "Make everything about your relationship.",
                r3_text: "ALIBI: Lakshmi was comforting you on the stairs when the body fell."
            }
        };

        // --- STATE & UTILS ---
        let currentUser = null;
        let pendingRound = 0;
        let timerInterval;

        function getEl(id) { return document.getElementById(id); }

        function handleLogin() {
            const input = getEl('pinInput').value.trim();
            const error = getEl('loginError');

            // --- THIS IS THE FIX: CHECK FOR 6969 ---
            if (input === '6969') {
                getEl('loginView').classList.add('hidden');
                getEl('adminView').classList.remove('hidden');
                renderMasterList();
                return;
            }

            if (CHARACTERS[input]) {
                currentUser = CHARACTERS[input];
                loadPlayerData();
                getEl('loginView').classList.add('hidden');
                getEl('playerView').classList.remove('hidden');
                error.classList.add('hidden');
            } else {
                error.classList.remove('hidden');
            }
        }

        function loadPlayerData() {
            getEl('playerDisplayName').innerText = currentUser.role + " (" + currentUser.name + ")";
            getEl('preGameText').innerText = currentUser.pre;
            getEl('r1Reveal').innerText = currentUser.r1_rev;
            getEl('r1Secret').innerText = currentUser.r1_sec;
            getEl('r2Clue').innerText = currentUser.r2_clue;
            getEl('r2Strategy').innerText = currentUser.r2_strat;
            getEl('r3Text').innerText = currentUser.r3_text;
        }

        function renderMasterList() {
            const container = getEl('masterListContainer');
            container.innerHTML = "";
            
            for (const [pin, char] of Object.entries(CHARACTERS)) {
                let html = `
                    <div class="master-row">
                        <strong class="red-text">${char.name}</strong> (${char.role})<br>
                        <strong>R1 Secret:</strong> ${char.r1_sec}<br>
                        <strong>R2 Clue (To Reveal):</strong> ${char.r2_clue}<br>
                        <strong>R3 Reveal:</strong> ${char.r3_text}
                    </div>
                `;
                container.innerHTML += html;
            }
        }

        function tryUnlock(roundNum) {
            const card = getEl('card' + roundNum);
            if (card.classList.contains('open')) {
                card.classList.remove('open');
                return;
            }
            pendingRound = roundNum;
            getEl('passwordModal').classList.remove('hidden');
            getEl('roundPasswordInput').value = "";
            getEl('roundPasswordInput').focus();
            getEl('pwdError').classList.add('hidden');
        }

        function checkPassword() {
            const input = getEl('roundPasswordInput').value.trim().toUpperCase();
            if (input === ROUND_PASSWORDS[pendingRound]) {
                getEl('card' + pendingRound).classList.remove('locked');
                getEl('card' + pendingRound).classList.add('open');
                getEl('lock' + pendingRound).innerText = 'ðŸ”“';
                closeModal();
            } else {
                getEl('pwdError').classList.remove('hidden');
            }
        }

        function closeModal() {
            getEl('passwordModal').classList.add('hidden');
        }

        // --- TIMER ---
        function startTimer(minutes) {
            stopTimer();
            let seconds = minutes * 60;
            updateTimerDisplay(seconds);
            timerInterval = setInterval(() => {
                seconds--;
                updateTimerDisplay(seconds);
                if (seconds <= 0) {
                    stopTimer();
                    alert("Time is up!");
                }
            }, 1000);
        }

        function stopTimer() { clearInterval(timerInterval); }

        function updateTimerDisplay(seconds) {
            const m = Math.floor(seconds / 60).toString().padStart(2, '0');
            const s = (seconds % 60).toString().padStart(2, '0');
            getEl('timer').innerText = `${m}:${s}`;
        }

        // Enter key listeners
        getEl('pinInput').addEventListener("keypress", (e) => { if (e.key === "Enter") handleLogin(); });
        getEl('roundPasswordInput').addEventListener("keypress", (e) => { if (e.key === "Enter") checkPassword(); });

    </script>
</body>
</html>
